{
	"name": "auto-pr-update",
	"description": "Derive PR titles from conventional commits when eligible and update PR descriptions before pushing changes",
	"hooks": [
		{
			"event": "PreToolUse",
			"matcher": {
				"tool": "Bash",
				"command": "git push"
			},
			"prompt": "A git push is about to happen. Check if there's an open PR for the current branch using the GitHub MCP tools. If a PR exists:\n\n1. Get the PR details and the list of files changed\n2. Analyze all commits on this branch (compared to the base branch)\n3. Decide whether to update the PR title (avoid churn):\n   - Eligibility (case-insensitive): Only auto-update if the current PR title starts with one of: feat:, fix:, refactor:, docs:, test:, chore:\n   - Collect commit subjects: Gather commit subject lines for all commits reachable from HEAD but not from the PR base branch (equivalent to `git log --no-merges base..HEAD`).\n   - Filter: Keep only subject lines that (case-insensitively) start with one of the prefixes above. If none, do not change the title.\n   - Choose a candidate title:\n     - Choose the highest-priority type present: fix > feat > refactor > docs > test > chore\n     - Within that type, choose the most recent matching subject as the candidate title\n   - Compare and apply:\n     - Use the candidate title verbatim (do not invent a new title and do not change its casing or punctuation)\n     - Normalize both titles for comparison by lowercasing, trimming whitespace, and removing trailing .!?\n     - If the normalized titles are equal, do not update; otherwise update the PR title to the candidate title\n   - Examples:\n     - Current title: `feat: add x`; commit subjects: [`feat: add x`, `chore: lint`] => no title change\n     - Current title: `feat: add x`; commit subjects: [`feat: add x`, `fix: handle x crash`] => update title to `fix: handle x crash`\n     - Current title: `Improve x`; commit subjects: [`feat: add x`] => no title change (non-conventional title)\n\n4. Update the PR description with:\n   - A clear summary of what changed (2-4 bullet points)\n   - Testing instructions based on the changes\n   - Keep any existing sections the user may have added manually\n\nUse this format for the PR body:\n\n## Summary\n- [bullet points describing changes]\n\n## Testing Instructions\n- [specific steps to test the changes]\n\n## Files Changed\n- [list key files with brief description of changes]\n\n---\nðŸ¤– Auto-updated by Claude Code\n\nIf no PR exists for this branch, do nothing."
		}
	]
}
